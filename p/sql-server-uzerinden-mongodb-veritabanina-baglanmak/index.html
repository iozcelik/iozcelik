<!doctype html><html lang=tr-tr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Sql server üzerinden linked server oluşturarak diğer ilişkisel veritabanlarına sorgu atmak uzun zamandır mevcut olan bir özellik. Ancak NoSql veritabanları için ise durum o kadar kolay değildi. Aslında Microsoft Sql Server 2016 ile duyurduğu PolyBase özelliği ile Hadoop ve Azure Blob Storage için bağlantılar kurma özelliğini eklemişti. MongoDB’yi sorgulamak için ise 2019 versiyonunu beklemek gerekecekti."><title>Sql Server üzerinden MongoDB veritabanına bağlanmak</title><link rel=canonical href=https://iozcelik.github.io/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/><link rel=stylesheet href=/iozcelik/scss/style.min.css><meta property="og:title" content="Sql Server üzerinden MongoDB veritabanına bağlanmak"><meta property="og:description" content="Sql server üzerinden linked server oluşturarak diğer ilişkisel veritabanlarına sorgu atmak uzun zamandır mevcut olan bir özellik. Ancak NoSql veritabanları için ise durum o kadar kolay değildi. Aslında Microsoft Sql Server 2016 ile duyurduğu PolyBase özelliği ile Hadoop ve Azure Blob Storage için bağlantılar kurma özelliğini eklemişti. MongoDB’yi sorgulamak için ise 2019 versiyonunu beklemek gerekecekti."><meta property="og:url" content="https://iozcelik.github.io/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/"><meta property="og:site_name" content="İsmail Özçelik"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="mongodb"><meta property="article:tag" content="mssql-linked-server"><meta property="article:published_time" content="2020-06-06T00:00:00+00:00"><meta property="article:modified_time" content="2020-06-06T00:00:00+00:00"><meta name=twitter:site content="ismailozcelik"><meta name=twitter:title content="Sql Server üzerinden MongoDB veritabanına bağlanmak"><meta name=twitter:description content="Sql server üzerinden linked server oluşturarak diğer ilişkisel veritabanlarına sorgu atmak uzun zamandır mevcut olan bir özellik. Ancak NoSql veritabanları için ise durum o kadar kolay değildi. Aslında Microsoft Sql Server 2016 ile duyurduğu PolyBase özelliği ile Hadoop ve Azure Blob Storage için bağlantılar kurma özelliğini eklemişti. MongoDB’yi sorgulamak için ise 2019 versiyonunu beklemek gerekecekti."></head><body><script>(function(){const colorSchemeKey='StackColorScheme';if(!localStorage.getItem(colorSchemeKey)){localStorage.setItem(colorSchemeKey,"auto");}})();</script><script>(function(){const colorSchemeKey='StackColorScheme';const colorSchemeItem=localStorage.getItem(colorSchemeKey);const supportDarkMode=window.matchMedia('(prefers-color-scheme: dark)').matches===true;if(colorSchemeItem=='dark'||colorSchemeItem==='auto'&&supportDarkMode){document.body.dataset.scheme='dark';}else{document.body.dataset.scheme='light';}})();</script><div class="container main-container flex on-phone--column extended article-page with-toolbar"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Menüyü Gizle">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header class=site-info><figure class=site-avatar><img src=/iozcelik/img/avatar_hubbbf2ad576efa7b07d3288713394c29c_4009_96x0_resize_box_2.png width=96 height=96 class=site-logo loading=lazy alt=Avatar>
<span class=emoji>💻</span></figure><h1 class=site-name><a href=https://iozcelik.github.io/iozcelik/>İsmail Özçelik</a></h1><h2 class=site-description>Biraz yazınca blog olacak</h2></header><ol class=menu id=main-menu><li><a href=/iozcelik/iozcelik/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Anasayfa</span></a></li><li><a href=/iozcelik/about><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>Hakkımda</span></a></li><li><a href=/iozcelik/archives><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Arşiv</span></a></li><li><a href=/iozcelik/search><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Arama</span></a></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Koyu Mod</span></li></ol></aside><main class="main full-width"><div id=article-toolbar><a href=https://iozcelik.github.io/iozcelik/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg><span>Back</span></a></div><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/iozcelik/categories/veritabani/ style=background-color:#2a9d8f;color:#fff>Veritabanı</a></header><h2 class=article-title><a href=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/>Sql Server üzerinden MongoDB veritabanına bağlanmak</a></h2><h3 class=article-subtitle>Sql server üzerinden linked server oluşturarak diğer ilişkisel veritabanlarına sorgu atmak uzun zamandır mevcut olan bir özellik. Ancak NoSql veritabanları için ise durum o kadar kolay değildi. Aslında Microsoft Sql Server 2016 ile duyurduğu PolyBase özelliği ile Hadoop ve Azure Blob Storage için bağlantılar kurma özelliğini eklemişti. MongoDB’yi sorgulamak için ise 2019 versiyonunu beklemek gerekecekti.</h3><footer class=article-time><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--published>06/06/2020</time></footer></div></header><section class=article-content><p>Sql server üzerinden linked server oluşturarak diğer ilişkisel veritabanlarına sorgu atmak uzun zamandır mevcut olan bir özellik. Ancak NoSql veritabanları için ise durum o kadar kolay değildi. Aslında Microsoft Sql Server 2016 ile duyurduğu PolyBase özelliği ile Hadoop ve Azure Blob Storage için bağlantılar kurma özelliğini eklemişti. MongoDB’yi sorgulamak için ise 2019 versiyonunu beklemek gerekecekti.</p><h3 id=peki-ya-biz-sql-server-2019dan-önceki-versiyonu-kullanıyorsak>Peki ya biz Sql Server 2019’dan önceki versiyonu kullanıyorsak?</h3><p>Burada çözüm olarak Linked server ile MongoDB veritabanına bağlanmak kalıyor. Bu konuda Türkçe çok fazla kaynak olmadığından dolayı detaylı bir şekilde bu konuyu anlatmaya çalışacağım.</p><p>Öncelikle MongoDB sitesinden güncel BI adaptörünü ve Github üzerinden güncel ODBC driverını indirip kuralım.</p><p>Kurulumlar bittikten sonra ilk önce indirmiş olduğumuz BI adaptörünü sistemimize Windows Service olarak kuralım. Bunun için yapmamız gereken Converter For BI klasörüne giderek “mongosqld.conf” isimli bir dosya oluşturmak.</p><pre><code class=language-command data-lang=command>C:\Program Files\MongoDB\Connector for BI\[güncel versiyon]\bin
</code></pre><p><figure style=flex-grow:317;flex-basis:762px><a href=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/mongodb-connector-for-bi.png data-size=702x221><img src=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/mongodb-connector-for-bi.png srcset="/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/mongodb-connector-for-bi_hu32f46dbd6bcca753ea1a20b3b7bf8a18_6991_480x0_resize_box_2.png 480w, /iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/mongodb-connector-for-bi_hu32f46dbd6bcca753ea1a20b3b7bf8a18_6991_1024x0_resize_box_2.png 1024w" width=702 height=221 loading=lazy alt="2.13 indirilen BI connector’un versiyon numarası"></a><figcaption>2.13 indirilen BI connector’un versiyon numarası</figcaption></figure></p><p>Bu dosya bize BI connector’un hangi veritabanına bağlanacağını ve diğer ayarlarını yapmamıza imkan veriyor. Oluşturulan dosyasının içerisine aşağıda ki ayarları ekleyelim.</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>systemLog</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;C:\logs\mongosqld.log&#39;</span><span class=w>
</span><span class=w></span><span class=nt>net</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>bindIp</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;127.0.0.1&#39;</span><span class=w>
</span><span class=w>  </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>3307</span><span class=w>
</span><span class=w></span><span class=nt>mongodb</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>net</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>uri</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;localhost:27017&#34;</span><span class=w>
</span><span class=w></span><span class=nt>schema</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>maxVarcharLength</span><span class=p>:</span><span class=w> </span><span class=m>8000</span><span class=w>
</span></code></pre></div><p>Burada dikkat edilmesi gerekenler;</p><ol><li>Sistem logunu yazmak için izin yoksa BI converter başlamayacaktır. Dosya izinlerinden emin olalım.</li><li>BindIp alanında daha sonra oluşturacağımız DSN’in hangi ip adresinden gelebileceği bilgisi mevcut. Birden fazla adres olabilir ancak server ise localhost’u kullanmayalım onun yerine Ip adresini açıkça yazalım.</li><li>MaxVarcharLength eklememizin sebebi olası bir hatayı almamak için. (Olası hata: “OLE DB provider “MSDASQL” for linked server “M” returned message “Requested conversion is not supported.”.”)</li><li>Eğer ilgili sunucuda tek bir veritabanına bağlanmak istiyorsanız şema adının belirtilmesi gerekir.
Şimdi sıra geldi Windows service olarak BI Connector’u başlatmaya. Bunun için aşağıdaki satırlar cmd’de (admin modda) execute edilir.</li></ol><pre><code class=language-command data-lang=command>&quot;C:\Program Files\MongoDB\Connector for BI\2.13\bin\mongosqld.exe&quot; install --config &quot;C:\Program Files\MongoDB\Connector for BI\2.13\bin\mongosqld.conf&quot;
</code></pre><p>Artık BI Connector, Windows service olarak yüklendi. İster cmd’den ister “Services” ekranından başlatabilirsiniz. Cmd için aşağıdaki satırı kullanabilirsiniz.</p><pre><code class=language-command data-lang=command>net start mongosql
</code></pre><p>Bu adımlardan sonra sırada MongoDB için bir tane Data Source Name (DSN) oluşturalım. DSN oluşturmak için “Başlat (Start)” üzerinden ODBC yazabiliriz.</p><p><figure style=flex-grow:148;flex-basis:356px><a href=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/odbc-data-sources.png data-size=356x240><img src=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/odbc-data-sources.png srcset="/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/odbc-data-sources_hu7f6032e6590bc8eb43fd16e46184820c_7807_480x0_resize_box_2.png 480w, /iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/odbc-data-sources_hu7f6032e6590bc8eb43fd16e46184820c_7807_1024x0_resize_box_2.png 1024w" width=356 height=240 loading=lazy alt="Bilgisayarınızda ya da serverda bulunan data sourcelara buradan ulaşılabilir"></a><figcaption>Bilgisayarınızda ya da serverda bulunan data sourcelara buradan ulaşılabilir</figcaption></figure></p><p>Açılan pencerede “System DSN” sekmesine geçiş yapalım ve açılan pencereden Unicode Driver’ı seçerek “Finish” butonuna basalım.</p><p><figure style=flex-grow:140;flex-basis:336px><a href=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/create-new-data-source.png data-size=590x421><img src=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/create-new-data-source.png srcset="/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/create-new-data-source_hu882ef07e297c8724552692718e3c8d0d_23650_480x0_resize_box_2.png 480w, /iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/create-new-data-source_hu882ef07e297c8724552692718e3c8d0d_23650_1024x0_resize_box_2.png 1024w" width=590 height=421 loading=lazy alt="Birden fazla veritabanı eklemesini bu ekrandan yapabilirsiniz."></a><figcaption>Birden fazla veritabanı eklemesini bu ekrandan yapabilirsiniz.</figcaption></figure></p><p>Daha sonra Configure butonu ile ayarlarımızı yapalım.</p><p><figure style=flex-grow:127;flex-basis:305px><a href=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/odbc-test-result.png data-size=600x472><img src=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/odbc-test-result.png srcset="/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/odbc-test-result_hucb963f4db115829a42aeec0767797be9_14861_480x0_resize_box_2.png 480w, /iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/odbc-test-result_hucb963f4db115829a42aeec0767797be9_14861_1024x0_resize_box_2.png 1024w" width=600 height=472 loading=lazy alt="Ayarlar kısmında dikkat edilmesi gereken ip ve port bilgisinin BI connector içerisinde bulunan config dosyasında bulunan ayarlarla aynı olmasıdır. Database isimleri genelde otomatik dolmuyor. Mongo veritabanı adını elle yazabilirsiniz."></a><figcaption>Ayarlar kısmında dikkat edilmesi gereken ip ve port bilgisinin BI connector içerisinde bulunan config dosyasında bulunan ayarlarla aynı olmasıdır. Database isimleri genelde otomatik dolmuyor. Mongo veritabanı adını elle yazabilirsiniz.</figcaption></figure></p><p>Ayarları yaptıktan sonra Test dediğimizde “Connection Successful” görmemiz gerekmekte. Buraya kadar MongoDB için ayarlarımızı yaptık. Şimdi de MSSQL üzerinden Linked Server oluşturma işlemine başlayalım. Bunun için Object Explorer’dan Server Object -> Linked Server seçimlerini yaptıktan sonra yeni bir Linked Server eklemesi yapalım.</p><p><figure style=flex-grow:110;flex-basis:264px><a href=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/new-linked-server.png data-size=690x625><img src=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/new-linked-server.png srcset="/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/new-linked-server_hu84bb165094c68a608e244bbcf20df6f4_11763_480x0_resize_box_2.png 480w, /iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/new-linked-server_hu84bb165094c68a608e244bbcf20df6f4_11763_1024x0_resize_box_2.png 1024w" width=690 height=625 loading=lazy alt="Daha önce eklediğimden hata vermişti:)"></a><figcaption>Daha önce eklediğimden hata vermişti:)</figcaption></figure></p><p>Ekleme tamamlandıktan sonra şimdi test etme zamanı. Bir select sorgusu ile mongo veritabanımızdan kayıtları alalım.</p><p><figure style=flex-grow:451;flex-basis:1084px><a href=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/example-linked-query-on-mongodb.png data-size=1188x263><img src=/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/example-linked-query-on-mongodb.png srcset="/iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/example-linked-query-on-mongodb_hu2ec229577a21d9470fbd6669bb9b6430_17796_480x0_resize_box_2.png 480w, /iozcelik/p/sql-server-uzerinden-mongodb-veritabanina-baglanmak/example-linked-query-on-mongodb_hu2ec229577a21d9470fbd6669bb9b6430_17796_1024x0_resize_box_2.png 1024w" width=1188 height=263 loading=lazy alt="Sorgumuz başarılı bir şekilde çalıştı"></a><figcaption>Sorgumuz başarılı bir şekilde çalıştı</figcaption></figure></p><p>Testimiz başarılı oldu. Bundan sonra rahat bir şekilde Mongo veritabanımıza Sql Server üzerinden ulaşabiliriz.</p><p>Ek bilgi olarak Mongo veritabanını sorgularken MySql Syntax kullanılamakta.</p></section><footer class=article-footer><section class=article-tags><a href=/iozcelik/tags/mongodb/>mongodb</a>
<a href=/iozcelik/tags/mssql-linked-server/>mssql-linked-server</a></section></footer></article><aside class=related-contents--wrapper></aside><footer class=site-footer><section class=copyright>&copy;
2020 İsmail Özçelik</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=2.0.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/iozcelik/ts/main.js defer></script><script>(function(){const customFont=document.createElement('link');customFont.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";customFont.type="text/css";customFont.rel="stylesheet";document.head.appendChild(customFont);}());</script></body></html>